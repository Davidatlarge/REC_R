---
title: "README"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## FIND OUT
- what is the result of `Estimating the best alpha Parameter` in `calculate_con_rates_lin_sys_tichonov_mean_rate_2`?  
- what does `[x_min, ind] = min(x_min_vec)` do in `find_local_minimum_with_smallest_x()`? Why does it get "overwritten" by the following line?  
- and `[mini,index] = min(-quot_crit)` in `calculate_con_rates_lin_sys_tichonov_mean_rate_2()`? 
- is `C_hat` in `calculate_con_rates_lin_sys_tichonov_mean_rate_2()` supposed to be a [N,N] matrix (as now) or a [N,1] matrix?  
  

## TODO
- change definition of an object `F` because it could be mistaken for `FALSE`  
- generally make nicer names for objects  
- remove the need for `read_bnd_cond_structure()` since it is anyways only a renaming, e.g. in   `calculate_diff_operator_matrix_aequi_dist_grid_variable_coeff()`.  
- calculate the fluxes in the main fun, now they are calculated only when written to file by `write_fluxes()`, or make the output so that the fluxes can be calculated by another fun from the output.  
- calculate integrated fluxes in the main fun, now they are calculated only when written to file by `integrate_rates()`, or make the output so that the fluxes can be calculated by another fun from the output.  
- but a name should be definable somewhere   
- make the result a list of result objects rather than writing them to file directly  
- make graphic output optional (if slow)  
- check where matrix multiplication is needed  
- check which functions can be used from `matlab::` just to make sure   
- bring back the figure printing? 
- include in results a report in text giving a step by step of the calculation and saying which parameters and conditions were used where use 
- `E` in `find mean rates` seems obsolete

# DONE
- replace data reading via files with direct data vector supply to function  
- does `diff_op` in `calculate_diff_operator_matrix_aequi_dist_grid_variable_coeff()` have to be a [N,N] matrix or should it be a [N,1] matrix? it creates many following matrices that want to be [N,1] but because of calculations with `diff_op` must become [N,N]. -- yes, but the initial multiplication with d was wrong, d had to be transposed from [1,N] into a [N,1] matrix rather than forced into a [N,N] matrix  



# TROUBLE SHOOTING
- try transposing the 1 col matrixes that were multiplied, added to square matrixes by changing `by.rows` argument.  
- change matrix multiplication to "simple" multiplication  

#### notes on data input files
fun `read_input_data_func()` just read in the data one by one, extracted from the concentration file the concentration and depth vectors, interpolated data to fit the number of grid points supplied in the top function
for each parameter read from file it did the same interpolation (extension to the required grid number)
by using the user defined function `operate_property()`.
**THE FUN IS OBSOLETE IF THE INPUT DATA IS DIRECTLY SUPPLIED AND INTERPOLATED IN THE TOP FUN**  

input files:  
- z - depth  
- C - concentration  
- phi - porosity  
- omega - vertical advection velocity  
- D - effective molecular diffusion coefficient D  
- Db - bioturabtion coefficient DB  
- beta - irrigation coefficient   
output objects:  
- z_data  
- C_data  
- z_c  
- C_c  
- omega  
- D_total  
- beta  
- phi  
- error  

```{r eval=FALSE}
read_input_data_func <- function(
  path_to_input_files # redundant is working with df from environment  
  N_c # Number of computational grid points ALSO IN MAIN FUN
  # objects created by reading the files:
  z_data,
  C_data,
  z_c,
  C_c,
  omega,
  D_total,
  beta,
  phi,
  error
){
  
  # ------ read concentrations AND DEPTH FROM THE CONCENTRATOIN FILE----------------
  z_c = matlab::linspace(z_data[1], z_data[length(z_data)], N_c) # 
  
  C_c = interp1(z_data, C_data, xi = z_c, method = "linear") # interp1() is the same in r and matlab
  
  # ---------- porosity ---------------------
  
}
```

